the old version of index.html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPDB Sekolah - Student Admission</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <!-- Navbar -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center">
                        <h1 class="text-xl font-bold">PPDB Sekolah</h1>
                    </div>
                    <div class="hidden md:ml-6 md:flex md:space-x-8">
                        <a href="#" class="border-indigo-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Home</a>
                        <a href="#" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Registration</a>
                        <a href="#" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Status</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="flex">
        <!-- Sidebar -->
        <div class="w-64 bg-white shadow-md h-screen">
            <div class="p-4">
                <ul class="space-y-2">
                    <li><a href="#" class="block p-2 text-gray-600 hover:bg-gray-100 rounded">Dashboard</a></li>
                    <li><a href="#" class="block p-2 text-gray-600 hover:bg-gray-100 rounded">New Registration</a></li>
                    <li><a href="#" class="block p-2 text-gray-600 hover:bg-gray-100 rounded">Requirements</a></li>
                    <li><a href="#" class="block p-2 text-gray-600 hover:bg-gray-100 rounded">Schedule</a></li>
                    <li><a href="#" class="block p-2 text-gray-600 hover:bg-gray-100 rounded">Contact</a></li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 p-10">
            <h2 class="text-2xl font-bold mb-4">Welcome to Student Admission 2024</h2>
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-xl font-semibold mb-2">Announcements</h3>
                <p class="text-gray-600 mb-4">Registration for the 2024 academic year is now open. Please ensure all required documents are prepared before starting your application.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="border p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">Important Dates</h4>
                        <ul class="list-disc pl-4 text-gray-600">
                            <li>Registration Opens: January 1, 2024</li>
                            <li>Registration Closes: March 31, 2024</li>
                            <li>Entrance Test: April 15, 2024</li>
                            <li>Results: April 30, 2024</li>
                        </ul>
                    </div>
                    <div class="border p-4 rounded-lg">
                        <h4 class="font-semibold mb-2">Quick Links</h4>
                        <ul class="list-disc pl-4 text-gray-600">
                            <li><a href="#" class="text-blue-500 hover:underline">Registration Form</a></li>
                            <li><a href="#" class="text-blue-500 hover:underline">Document Requirements</a></li>
                            <li><a href="#" class="text-blue-500 hover:underline">FAQ</a></li>
                            <li><a href="#" class="text-blue-500 hover:underline">Contact Support</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>


`` python ``
from flask import Blueprint, render_template, request, flash, redirect, url_for
from flask_login import login_required, current_user
from app.models import Form
from app import db

form_bp = Blueprint('form', __name__, template_folder='templates')

@form_bp.route('/pendaftaran', methods=['GET', 'POST'])
@login_required
def pendaftaran():
    if request.method == 'POST':
        # Get form data
        student_name = request.form.get('student_name')
        student_age = request.form.get('student_age')
        school_name = request.form.get('school_name')

        # Validate form data
        if not student_name or not student_age or not school_name:
            flash('Semua field harus diisi!', 'error')
            return redirect(url_for('form.pendaftaran'))

        try:
            # Create new form submission
            new_form = Form(
                user_id=current_user.id,
                student_name=student_name,
                student_age=int(student_age),
                school_name=school_name
            )

            # Save to database
            db.session.add(new_form)
            db.session.commit()

            flash('Pendaftaran berhasil disubmit!', 'success')
            return redirect(url_for('form.status'))

        except Exception as e:
            db.session.rollback()
            flash('Terjadi kesalahan saat mendaftar. Silakan coba lagi.', 'error')
            return redirect(url_for('form.pendaftaran'))

    return render_template('parts/form.html')

@form_bp.route('/status')
@login_required
def status():
    # Get user's form submissions
    submissions = Form.query.filter_by(user_id=current_user.id).all()
    return render_template('form/status.html', submissions=submissions)


    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Login</title>
        <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
        <link rel="website icon" type="png" href="{{ url_for('static', filename='anonymous.jpg')}}">
    </head>
    <body class="bg-gray-100">
        <div class="min-h-screen flex items-center justify-center">
            <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-md">
                <h2 class="text-2xl font-bold mb-6 text-center">Login</h2>
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        <div class="mb-4">
                            {% for category, message in messages %}
                                <div class="p-4 mb-4 text-sm text-{{ 'red' if category == 'danger' else 'green' }}-700 bg-{{ 'red' if category == 'danger' else 'green' }}-100 rounded-lg" role="alert">
                                    {{ message }}
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}
                {% endwith %}
                <form action="{{ url_for('auth_bp.login') }}" method="POST">
                    <div class="mb-4">
                        <label for="username" class="block text-gray-700">Username</label>
                        <input type="text" id="username" name="username" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-black focus:border-black sm:text-sm" required>
                    </div>
                    <div class="mb-4">
                        <label for="password" class="block text-gray-700">Password</label>
                        <input type="password" id="password" name="password" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-black focus:border-black sm:text-sm" required>
                    </div>
                    <div class="mb-6">
                        <button type="submit" class="w-full bg-black text-white py-2 px-4 rounded-md hover:bg-black focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2">Login</button>
                    </div>
                    <div class="text-center">
                        <p class="text-gray-600">Don't have an account? <a href="{{ url_for('auth_bp.register') }}" class="text-black hover:underline">Register</a></p>
                    </div>
                </form>
            </div>
        </div>
    </body>
    </html>

<!-- app/templates/board/edit_board.html -->
    {% extends "base.html" %}

    {% block title %}Edit Board - {{ board.title }}{% endblock %}
    
    {% block content %}
    <div class="min-h-screen bg-gray-50 py-8">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Back Navigation -->
            <div class="max-w-md mx-auto mb-6">
                <a href="{{ url_for('index_bp.view_board', board_id=board.id) }}" 
                   class="inline-flex items-center text-gray-600 hover:text-gray-800">
                    <i class="bi bi-arrow-left mr-2"></i>
                    Back to Board
                </a>
            </div>
    
            <!-- Edit Form Card -->
            <div class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden">
                <!-- Card Header -->
                <div class="bg-gray-800 px-6 py-4">
                    <h1 class="text-xl font-semibold text-white flex items-center">
                        <i class="bi bi-pencil-square mr-2"></i>
                        Edit Board
                    </h1>
                </div>
    
                <!-- Form Content -->
                <div class="p-6">
                    <form method="POST" action="{{ url_for('board_bp.edit_board', board_id=board.id) }}"
                          class="space-y-6">
                        <!-- Title Input -->
                        <div>
                            <label for="title" 
                                   class="block text-sm font-medium text-gray-700 mb-2">
                                Board Title
                            </label>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i class="bi bi-layout-text-window text-gray-400"></i>
                                </div>
                                <input type="text" 
                                       id="title" 
                                       name="title" 
                                       value="{{ board.title }}"
                                       required
                                       class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm"
                                       placeholder="Enter board title">
                            </div>
                            
                            <!-- Creation Date Info -->
                            <p class="mt-2 text-xs text-gray-500">
                                Created on {{ board.created_at.strftime('%B %d, %Y') }}
                            </p>
                        </div>
    
                        <!-- Flash Messages -->
                        {% with messages = get_flashed_messages(with_categories=true) %}
                            {% if messages %}
                                {% for category, message in messages %}
                                    <div class="rounded-md p-4 {% if category == 'error' %}bg-red-50 text-red-700{% else %}bg-green-50 text-green-700{% endif %}">
                                        <p class="text-sm">{{ message }}</p>
                                    </div>
                                {% endfor %}
                            {% endif %}
                        {% endwith %}
    
                        <!-- Form Actions -->
                        <div class="flex items-center justify-between space-x-4">
                            <div class="flex items-center space-x-4">
                                <a href="{{ url_for('index_bp.view_board', board_id=board.id) }}"
                                   class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                    Cancel
                                </a>
                                <button type="submit"
                                        class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                    <i class="bi bi-check-lg mr-2"></i>
                                    Save Changes
                                </button>
                            </div>
                            
                            <!-- Delete Button -->
                            <form action="{{ url_for('board_bp.delete_board', board_id=board.id) }}"
                                  method="POST"
                                  onsubmit="return confirm('Are you sure you want to delete this board? This action cannot be undone.');"
                                  class="inline">
                                <button type="submit"
                                        class="inline-flex items-center px-4 py-2 border border-transparent rounded-md text-sm font-medium text-red-600 hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                                    <i class="bi bi-trash mr-2"></i>
                                    Delete
                                </button>
                            </form>
                        </div>
                    </form>
                </div>
            </div>
    
            <!-- Board Stats -->
            <div class="max-w-md mx-auto mt-6">
                <div class="bg-white rounded-lg shadow-sm p-4">
                    <h2 class="text-sm font-medium text-gray-700 mb-2">Board Statistics</h2>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-sm text-gray-600">
                            <i class="bi bi-list-check mr-1"></i>
                            {{ board.lists|length }} Lists
                        </div>
                        <div class="text-sm text-gray-600">
                            <i class="bi bi-calendar3 mr-1"></i>
                            {{ board.created_at.strftime('%Y-%m-%d') }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endblock %}


@form_bp.route('/status')
@login_required  # Pastikan user sudah login
def status():
    # Ambil data terakhir yang di-submit oleh user
    latest_submission = Form.query.filter_by(
        user_id=current_user.id
    ).order_by(Form.id.desc()).first()

    if not latest_submission:
        flash('Belum ada data pendaftaran', 'error')
        return redirect(url_for('form_bp.pendaftaran'))

    return render_template(
        'parts/status.html',
        submission=latest_submission,
        # Jika perlu format tanggal:
        # timestamp=latest_submission.timestamp.strftime("%d %B %Y %H:%M")
    )

@form_bp.route('/uploads/<filename>')
def uploaded_file(filename):
    return send_from_directory(current_app.config['UPLOAD_FOLDER'], filename)


<!-- studentdashboard.html -->
{% extends "base.html" %}

{% block content %}
<div class="min-h-screen bg-gray-100 p-8">
    <div class="max-w-7xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-900 mb-8">Student Dashboard</h1>
        
        <!-- New Registration Button -->
        <div class="mb-8">
            <a href="{{ url_for('form_bp.pendaftaran') }}" 
               class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg">
                + New Registration
            </a>
        </div>

        <!-- Applications List -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for form in user_forms %}
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center mb-4">
                    <img class="h-16 w-16 rounded-full object-cover mr-4"
                         src="{{ url_for('static', filename='uploads/student_images/' + form.image_path) }}" 
                         alt="Student photo">
                    <div>
                        <h2 class="text-xl font-bold text-gray-900">{{ form.student_name }}</h2>
                        <p class="text-sm text-gray-500">{{ form.school_name }}</p>
                    </div>
                </div>
                
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Status:</span>
                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                            {% if form.status == 'verified' %}bg-green-100 text-green-800
                            {% elif form.status == 'rejected' %}bg-red-100 text-red-800
                            {% else %}bg-yellow-100 text-yellow-800{% endif %}">
                            {{ form.status|upper }}
                        </span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Age:</span>
                        <span class="text-gray-900">{{ form.student_age }}</span>
                    </div>
                    {% if form.verification_note %}
                    <div class="mt-4 p-3 bg-gray-50 rounded-lg">
                        <p class="text-sm text-gray-600">
                            <span class="font-medium">Admin Note:</span> 
                            {{ form.verification_note }}
                        </p>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% else %}
            <div class="col-span-full text-center py-12">
                <p class="text-gray-500">No registration submissions yet</p>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}


@form_bp.route('/student/dashboard')
@login_required
def student_dashboard():
    user_forms = Form.query.filter_by(user_id=current_user.id).order_by(Form.id.desc()).all()
    return render_template('parts/studentdashboard.html', user_forms=user_forms)

from flask import Blueprint, render_template, request, flash, redirect, url_for
from flask_login import login_required, current_user
from app.models import Form, User, UserRole
from app import db
from datetime import datetime
from functools import wraps

admin_bp = Blueprint('admin_bp', __name__, template_folder='templates')

def admin_required(f):
    @wraps(f)
    def decorated_function(*args, **kwargs):
        if not current_user.is_authenticated or current_user.role != UserRole.ADMIN.value:
            flash('Anda tidak memiliki akses ke halaman ini.', 'error')
            return redirect(url_for('index.home'))
        return f(*args, **kwargs)
    return decorated_function

@admin_bp.route('admin/dashboard')
@login_required
@admin_required
def dashboard():
    pending_forms = Form.query.filter_by(status='pending').all()
    return render_template('parts/admindashboard.html', forms=pending_forms)

@admin_bp.route('/verify/<int:form_id>', methods=['POST'])
@login_required
@admin_required
def verify_form(form_id):
    form = Form.query.get_or_404(form_id)
    action = request.form.get('action')
    note = request.form.get('note')

    if action not in ['approve', 'reject']:
        flash('Aksi tidak valid', 'error')
        return redirect(url_for('admin_bp.dashboard'))

    form.status = 'approved' if action == 'approve' else 'rejected'
    form.verified_by = current_user.id
    form.verification_date = datetime.utcnow()
    form.verification_note = note

    try:
        db.session.commit()
        flash(f'Formulir telah berhasil di{action}', 'success')
    except Exception as e:
        db.session.rollback()
        flash('Terjadi kesalahan saat memverifikasi formulir', 'error')

    return redirect(url_for('admin_bp.dashboard'))

<- student.py ->

from flask import Blueprint, render_template, request, flash, redirect, url_for, current_app
from flask_login import login_required, current_user

student_bp = Blueprint('student_bp', __name__, template_folder='templates')

@student_bp.route('/student_dashboard', methods=['GET'])
def student_dashboard():
    """Render the student dashboard."""
    return render_template('parts/studentdashboard.html', user=current_user)


< - old email.py - >
# Library untuk mengirim email verifikasi pendaftaran siswa baru ke email peserta didik yang terverifikasi
from flask import current_app
from .email_config import send_email

def send_verification_email(user_email, student_name):
    try:
        subject = 'Pendaftaran Anda Telah Diverifikasi'
        message = f"""
        Yth. {student_name},
        
        Selamat! Anda telah diterima dalam proses pendaftaran siswa baru.
        Pembayaran Anda telah diverifikasi dan pendaftaran Anda telah dikonfirmasi.
        
        Silahkan login ke akun Anda untuk melihat informasi lebih lanjut.
        
        Terima kasih,
        Admin PPDB
        """
        
        return send_email(user_email, subject, message)
        
    except Exception as e:
        current_app.logger.error(f"Error sending verification email: {str(e)}")
        return False


<- old admin_email.py ->
from flask import current_app
from .email_config import send_email

def send_admin_notification(admin_email, student_name):
    try:
        subject = 'Peserta Didik Baru Terdaftar'
        message = f"""
        Kepada Admin,
        
        Dengan ini diberitahukan bahwa:
        
        Nama Siswa: {student_name}
        
        telah berhasil menjadi peserta didik baru di sekolah kita.
        Mohon untuk segera mempersiapkan administrasi yang diperlukan.
        
        Terima kasih,
        Sistem PPDB
        """
        
        return send_email(admin_email, subject, message)
        
    except Exception as e:
        current_app.logger.error(f"Error sending admin notification: {str(e)}")
        return False


# app/templates/parts/manage_requirements.html
{% extends "adminbase.html" %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="mb-8 flex justify-between items-center">
        <h1 class="text-2xl font-bold">Kelola Persyaratan</h1>
        <button onclick="showAddModal()" 
                class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
            </svg>
            Tambah Persyaratan
        </button>
    </div>

    <!-- Requirements List -->
    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
        {% if requirements %}
        <div class="mb-4">
            <div class="text-sm text-gray-600">Total persyaratan: {{ requirements|length }}</div>
        </div>
        {% endif %}
        <table class="min-w-full">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Judul</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Deskripsi</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Terakhir Diperbarui</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Aksi</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for req in requirements %}
                <tr>
                    <td class="px-6 py-4">{{ req.title }}</td>
                    <td class="px-6 py-4">{{ req.description }}</td>
                    <td class="px-6 py-4">{{ req.updated_at.strftime('%d %B %Y') }}</td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2">
                            <button onclick="showEditModal('{{ req.id }}', '{{ req.title }}', '{{ req.description }}')"
                                    class="text-blue-600 hover:text-blue-900">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                            <button onclick="deleteRequirement('{{ req.id }}')"
                                    class="text-red-600 hover:text-red-900">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                            </button>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Add/Edit Modal -->
    <div id="requirementModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden overflow-y-auto h-full w-full">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <h3 class="text-lg font-medium text-gray-900 mb-4" id="modalTitle">Tambah Persyaratan</h3>
                <form id="requirementForm" method="POST" action="{{ url_for('admin_bp.manage_requirements') }}">
                    <input type="hidden" name="action" id="formAction" value="add">
                    <input type="hidden" name="requirement_id" id="requirementId">
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700">Judul</label>
                        <input type="text" name="title" id="titleInput"
                               class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                               required>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700">Deskripsi</label>
                        <textarea name="description" id="descriptionInput"
                                  class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                                  rows="4" required></textarea>
                    </div>
                    
                    <div class="flex justify-end space-x-3">
                        <button type="button" onclick="closeModal()"
                                class="bg-gray-200 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-300">
                            Batal
                        </button>
                        <button type="submit"
                                class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                            Simpan
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="fixed bottom-4 right-4 max-w-md transition-opacity duration-300 opacity-0">
        <div class="bg-white rounded-lg shadow-lg p-4">
            <div class="flex items-start">
                <div id="notificationIcon" class="flex-shrink-0">
                    <!-- Icon will be inserted by JS -->
                </div>
                <div class="ml-3 w-0 flex-1">
                    <p id="notificationMessage" class="text-sm font-medium text-gray-900">
                        <!-- Message will be inserted by JS -->
                    </p>
                </div>
                <div class="ml-4 flex-shrink-0 flex">
                    <button onclick="hideNotification()" class="rounded-md inline-flex text-gray-400 hover:text-gray-500">
                        <span class="sr-only">Close</span>
                        <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function showAddModal() {
    document.getElementById('modalTitle').textContent = 'Tambah Persyaratan';
    document.getElementById('formAction').value = 'add';
    document.getElementById('requirementId').value = '';
    document.getElementById('titleInput').value = '';
    document.getElementById('descriptionInput').value = '';
    document.getElementById('requirementModal').classList.remove('hidden');
}

function showEditModal(id, title, description) {
    document.getElementById('modalTitle').textContent = 'Edit Persyaratan';
    document.getElementById('formAction').value = 'edit';
    document.getElementById('requirementId').value = id;
    document.getElementById('titleInput').value = title;
    document.getElementById('descriptionInput').value = description;
    document.getElementById('requirementModal').classList.remove('hidden');
}

function closeModal() {
    document.getElementById('requirementModal').classList.add('hidden');
}

function deleteRequirement(id) {
    if (confirm('Apakah Anda yakin ingin menghapus persyaratan ini?')) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = "{{ url_for('admin_bp.manage_requirements') }}";
        
        const actionInput = document.createElement('input');
        actionInput.type = 'hidden';
        actionInput.name = 'action';
        actionInput.value = 'delete';
        
        const idInput = document.createElement('input');
        idInput.type = 'hidden';
        idInput.name = 'requirement_id';
        idInput.value = id;
        
        form.appendChild(actionInput);
        form.appendChild(idInput);
        document.body.appendChild(form);
        form.submit();
    }
}

function showNotification(message, type = 'success') {
    const notification = document.getElementById('notification');
    const notificationMessage = document.getElementById('notificationMessage');
    const notificationIcon = document.getElementById('notificationIcon');
    
    // Set message
    notificationMessage.textContent = message;
    
    // Set icon based on type
    const iconColor = type === 'success' ? 'text-green-400' : 'text-red-400';
    const iconPath = type === 'success' 
        ? 'M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z'
        : 'M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z';
    
    notificationIcon.innerHTML = `
        <svg class="h-6 w-6 ${iconColor}" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="${iconPath}" clip-rule="evenodd"/>
        </svg>
    `;
    
    // Show notification
    notification.classList.remove('opacity-0');
    
    // Hide after 3 seconds
    setTimeout(hideNotification, 3000);
}

function hideNotification() {
    const notification = document.getElementById('notification');
    notification.classList.add('opacity-0');
}

// Add success/error handling for form submissions
document.getElementById('requirementForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    try {
        const formData = new FormData(e.target);
        const response = await fetch(e.target.action, {
            method: 'POST',
            body: formData
        });
        
        if (response.ok) {
            showNotification('Persyaratan berhasil disimpan', 'success');
            setTimeout(() => window.location.reload(), 1000);
        } else {
            showNotification('Gagal menyimpan persyaratan', 'error');
        }
    } catch (error) {
        showNotification('Terjadi kesalahan', 'error');
    }
});

// Close modal when clicking outside
document.getElementById('requirementModal').addEventListener('click', function(e) {
    if (e.target === this) {
        closeModal();
    }
});

// Close modal with Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeModal();
    }
});
</script>
{% endblock %}